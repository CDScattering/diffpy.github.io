

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Tutorial and Example &mdash; SrRietveld 1.0-r6875 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0-r6875',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="SrRietveld 1.0-r6875 documentation" href="index.html" />
    <link rel="next" title="Scripting Interface" href="scripting_interface.html" />
    <link rel="prev" title="Installation" href="install.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="scripting_interface.html" title="Scripting Interface"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="install.html" title="Installation"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">SrRietveld 1.0-r6875 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tutorial and Example</a><ul>
<li><a class="reference internal" href="#example">Example</a><ul>
<li><a class="reference internal" href="#experiment-data">Experiment Data</a></li>
<li><a class="reference internal" href="#create-the-example-folder">Create the Example Folder</a><ul>
<li><a class="reference internal" href="#for-windows-users">For Windows Users</a></li>
<li><a class="reference internal" href="#for-linux-unix-users">For Linux/Unix Users</a></li>
</ul>
</li>
<li><a class="reference internal" href="#start-srrietveld-gui">Start SrRietveld GUI</a></li>
<li><a class="reference internal" href="#creating-a-simple-project-using-a-preexisting-exp-pcr-file">Creating a Simple Project Using a Preexisting EXP/PCR File</a></li>
<li><a class="reference internal" href="#the-setup-panels-and-strategy-editor">The Setup Panels and Strategy Editor</a></li>
<li><a class="reference internal" href="#load-data">Load Data</a></li>
<li><a class="reference internal" href="#refinement-strategy">Refinement Strategy</a></li>
<li><a class="reference internal" href="#real-time-plotting">Real Time Plotting</a></li>
<li><a class="reference internal" href="#add-a-job-to-the-job-list">Add a job to the job list</a></li>
<li><a class="reference internal" href="#start-the-sequential-refinement">Start the Sequential Refinement</a></li>
<li><a class="reference internal" href="#handling-divergent-refinements">Handling Divergent Refinements</a></li>
<li><a class="reference internal" href="#viewing-the-results">Viewing the Results</a></li>
<li><a class="reference internal" href="#setup-and-run-the-fullprof-refinement-with-srrietveld">Setup and Run the FullProf Refinement with SrRietveld</a></li>
<li><a class="reference internal" href="#after-the-refinement">After the Refinement</a><ul>
<li><a class="reference internal" href="#export-the-data-view-to-csv-file">Export the data view to CSV file</a></li>
<li><a class="reference internal" href="#load-the-data-view-from-a-text-data-file">Load the data view from a text data file</a></li>
<li><a class="reference internal" href="#export-the-refinement-setup-files">Export the refinement setup files</a></li>
<li><a class="reference internal" href="#export-the-distance-and-angle-information-from-the-refinement">Export the distance and angle information from the refinement</a></li>
</ul>
</li>
<li><a class="reference internal" href="#re-running-the-refinement">Re-running the Refinement</a></li>
<li><a class="reference internal" href="#stop-the-sequential-refinement">Stop the Sequential Refinement</a></li>
<li><a class="reference internal" href="#saving-and-loading-project-files">Saving and Loading Project Files</a></li>
<li><a class="reference internal" href="#archive-the-project-file-and-source-files-in-zip">Archive the Project File and Source Files in zip</a></li>
</ul>
</li>
<li><a class="reference internal" href="#bug-report-and-user-feedback">Bug Report and User Feedback</a><ul>
<li><a class="reference internal" href="#bugs-bite-me">Bugs Bite Me!</a></li>
<li><a class="reference internal" href="#user-feedback-and-community">User Feedback and Community</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="install.html"
                        title="previous chapter">Installation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="scripting_interface.html"
                        title="next chapter">Scripting Interface</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="tutorial-and-example">
<span id="tutorial"></span><h1>Tutorial and Example<a class="headerlink" href="#tutorial-and-example" title="Permalink to this headline">¶</a></h1>
<p>This tutorial contains a guide for users to complete an example Rietveld parametric refinement with SrRietveld, as well as other major functionalities in SrRietveld software.</p>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>The data files for this example can be downloaded from <a class="reference external" href="http://danse.cacr.caltech.edu/packages/dev_danse_us/srrietveld-examples.zip">here</a>.</p>
<div class="section" id="experiment-data">
<h3>Experiment Data<a class="headerlink" href="#experiment-data" title="Permalink to this headline">¶</a></h3>
<p><strong>Sample</strong>: NaCl (sodium chloride) from Puratronic® (99.999%, 5N grade), contained in a 1 mm diameter Kapton tube mounted perpendicular to the synchrotron beam.</p>
<p><strong>Beamline</strong>: 11-ID-B at Advanced Photon Source (APS) at Argonne National Laboratory (ANL). The beam energy is 58keV and x-ray wavelength of 0.21281Å.</p>
<p><strong>Temperature ramping</strong>: The temperature was ramped continuously from 155.2 K to 500 K at a speed of 3 K/min.</p>
<p><strong>Instruments</strong>: The sample was cooled using a Oxford cryostream cooler. The data were collected on a 2D Perkin-Elmer amorphous silicon detector mounted 128.6mm behind the sample and perpendicular to the beam.</p>
</div>
<div class="section" id="create-the-example-folder">
<h3>Create the Example Folder<a class="headerlink" href="#create-the-example-folder" title="Permalink to this headline">¶</a></h3>
<p>We recommend the users to create a new working directory and work on this example within this new folder.</p>
<div class="section" id="for-windows-users">
<h4>For Windows Users<a class="headerlink" href="#for-windows-users" title="Permalink to this headline">¶</a></h4>
<p>Create a new folder on your hard drive. And put the downloaded example package into the newly created folder. Unzip the package.</p>
</div>
<div class="section" id="for-linux-unix-users">
<h4>For Linux/Unix Users<a class="headerlink" href="#for-linux-unix-users" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>Linux/Unix users may need to type in commands in a terminal. Examples of commands that need to be typed on the command line are shown boxed in bold like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">this</span>
</pre></div>
</div>
</div></blockquote>
<p>It should be possible to cut and paste them from the documentation into the command prompt to save you time. Text in angle brackets should be replaced with the value relevant to your case.</p>
<p>Begin by creating your working directory:</p>
<div class="highlight-python"><pre>mkdir path/to/my/working/directory</pre>
</div>
<p>The downloaded package is in the form of a zipped archive file.  Save the zip file in your working directory.  It should be possible to do this from the browser by right clicking on the link and browsing to the right directory.  Go to the working directory:</p>
<div class="highlight-python"><pre>cd path/to/my/working/directory</pre>
</div>
<p>and unpack the zip file:</p>
<div class="highlight-python"><pre>unzip srrietveld-examples.zip</pre>
</div>
<p>This should create a directory tree with all of the example data: <em>NaCl_RAPDF_example</em></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>After the zip file just downloaded is extracted, the contents of the <em>NaCl_RAPDF_example</em> folder can be read as following,</p>
<p><em>Data</em> - a directory that contains all the raw data in CHI format files</p>
<p><em>NaCl.srr</em> - a HDF5 format binary project file contains the refinement setup and results of this example. This example project contains two experiments, one is refined with GSAS as the refinement engine and the other is refined with FullProf.  This is created by SrRietveld and can, in turn, be read by SrRietveld.  You will create this file when you do the tutorial.  This is provided by way of a solution to the problem.  You can check your project file against this one.</p>
<p><em>NaCl.EXP</em> - the refinement setup file for the GSAS engine.  This file can be created or edited using programs such as EXPGUI.</p>
<p class="last"><em>NaCl.pcr</em> - the refinement setup file for the FullProf engine. This file can be created or edited using programs such as WinPLOTR.</p>
</div>
</div>
</div>
<div class="section" id="start-srrietveld-gui">
<h3>Start SrRietveld GUI<a class="headerlink" href="#start-srrietveld-gui" title="Permalink to this headline">¶</a></h3>
<p>Once the SrRietveld program is properly setup and the example files are downloaded, the user can start SrRietveld to run the examples. On Windows, SrRietveld can be started by clicking the quick link icon on the desktop or in program list.</p>
<p>To start SrRietveld in Linux/Unix, type on the command line:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">srrietveld</span>
</pre></div>
</div>
<p>If the system cannot find the <em>srrietveld</em> command, the system <em>PATH</em> environment variable may not be set up correctly. Please go back to the <cite>installation</cite> section of SrRietveld, and check if the script path is added to the system <em>PATH</em> variable.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">SrRietveld is a cross platform application,  its Graphical User Interface looks and behaves the same on different operating systems. Details about the GUI layout can be found <a class="reference internal" href="reference.html#sec-main-window-layout"><em>here</em></a>.</p>
</div>
<blockquote id="fg-layout-of-srrietveld-main-window">
<div><a class="reference external" href="_images/SrRietveld1.png">Enlarge</a></div></blockquote>
<img alt="_images/SrRietveld1.png" class="align-center" src="_images/SrRietveld1.png" style="width: 602px;" />
<p class="centered">
<strong>Layout of the SrRietveld main window. There are three main panels. On the left is
the &#8220;Experiments&#8221; panel, the role of the main panel on the right is context sensitive, it
changes depending on what is selected in the experiments panel, but it will be used for editing and
controlling refinements, and viewing numerical results.  The bottom panel is the &#8220;Output&#8221; panel that
shows outputs from SrRietveld engines as they run.  At the top is a toolbar and a number of drop-down lists.
The layout of the GUI can be reconfigured by sliding boundaries between panels.  Panels can also be undocked
and redocked in a different arrangement by grabbing the top of the panel by holding down the left
mouse button and dragging the mouse.</strong></p></div>
<div class="section" id="creating-a-simple-project-using-a-preexisting-exp-pcr-file">
<h3>Creating a Simple Project Using a Preexisting EXP/PCR File<a class="headerlink" href="#creating-a-simple-project-using-a-preexisting-exp-pcr-file" title="Permalink to this headline">¶</a></h3>
<p>Each time you open SrRietveld you are working on a single project.  You can open an existing project or
start a new project.  Here we will start a new project by clicking on <strong>File-&gt;New project</strong>.  When SrRietveld
starts, a new empty project will be loaded in the work place automatically.</p>
<p>Within a project we can create <em>refinements</em>, which may contain a series of related <em>fit</em> s.
Each fit may contain one or more phases and one or more histogram files. In conventional Rietveld refinement
jobs, users usually work on one fit each refinement.</p>
<p>SrRietveld uses an <em>EXP</em> (for GSAS refinement) or <em>PCR</em> (for FullProf refinement) as template to create a
refinement. The same settings, including the refinement strategy (see <a class="reference internal" href="#refinement-strategy"><em>here</em></a>)
will be applied to all <em>fit</em> s in a refinement.</p>
<p>In the current example we have a series of 320 NaCl data-sets collected as a function of temperature.  We
are going to create an <em>project</em>, which contains a GSAS <em>refinement</em> and FullProf <em>refinement</em>. The refinements
will be sequentially refined with corresponding engine.</p>
<p>To add a new <em>refinement</em> to the project, one can click on the <strong>Add new refinement</strong> icon on the toolbar, or
<strong>File-&gt;New fit...</strong> on the menu bar, or right click on an empty area on the experiments panel.</p>
<p>A file dialog will pop up. Then navigate in the file dialog to the NaCl example folder and select NaCl.EXP.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>It is possible to override this step and create a new project with a new experiment directly by typing at the command line:</p>
<div class="highlight-python"><pre>srrietveld NaCl.EXP</pre>
</div>
<p>or</p>
<div class="highlight-python"><pre>srrietveld NaCl.pcr</pre>
</div>
<p>This will launch SrRietveld GUI with the experiment pre-created provided the NaCl.EXP file is present in the current directory.</p>
<p class="last">To learn how to run SrRietveld from command line, please see the instructions <a class="reference internal" href="reference.html#run-from-command-line"><em>here</em></a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Currently, users need to use GSAS (EXPGUI) or FullProf (WinPLOTR) to create the EXP / PCR setup files to create a new experiment in SrRietveld. Users can change the initial values of the refinement. But can not alter the number of phases or number of atoms specified in the EXP/PCR files.</p>
</div>
</div>
<div class="section" id="the-setup-panels-and-strategy-editor">
<h3>The Setup Panels and Strategy Editor<a class="headerlink" href="#the-setup-panels-and-strategy-editor" title="Permalink to this headline">¶</a></h3>
<p>After the EXP or PCR file has been loaded you will see a list of icons in the <em>Experiments</em> panel (left panel).
The refinement parameters are categorized into different folders. (<a class="reference internal" href="reference.html#fg-experiments-panel"><em>Figure</em></a>). Users can
navigate through the icons, the values of contained parameters will show to the right panel.</p>
<blockquote>
<div><p><strong>NaCl_EXP</strong> &#8211; the name of the refinement</p>
<blockquote>
<div><p><strong>All variables</strong> &#8211; all refinement setting parameters</p>
<p><strong>Phase</strong> &#8211; The phase information, such as the lattice parameters, phase name, atoms, etc.</p>
<p><strong>Patterns</strong> &#8211; The histogram file information, such as the data file path, instrument file path, incident spectrum data file, etc.</p>
<p><strong>Profile</strong> &#8211; The setup parameter for the profile, such as the scale factor, zero shift, etc.</p>
</div></blockquote>
<p><strong>Strategy</strong> &#8211; The strategy setup interface.  (see <a class="reference internal" href="#refinement-strategy"><em>here</em></a>)</p>
<p><strong>User defined</strong> &#8211; user created category.</p>
</div></blockquote>
<p>Right click on the icons will trigger a context menu, which provides additional functionalities.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">User can define their own category icon under the User defined. Just right click on the <em>User defined</em> icon, click <em>Add child</em></p>
</div>
</div>
<div class="section" id="load-data">
<h3>Load Data<a class="headerlink" href="#load-data" title="Permalink to this headline">¶</a></h3>
<p>Next the data will be loaded into the refinement.
First, select the refinement on the experiment panel (left panel), the click the <em>Load the data to a refinement</em>
icon. A file dialog will open. After the user selected the data file or data list information file from the file
dialog, the</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">User can also use the <em>Ctrl+L</em> shortcut or by clicking <em>Load-&gt;Data</em> to open the dialog.</p>
</div>
<p>There are two schemes to load a sequence of data into the refinement:</p>
<ul class="simple">
<li>User can directly select the data files to load. An index will be automatically generated for the list.</li>
<li>To associate the list of data files with the environment variables, user can prepare a INFO file, which will
contain the list of environment variable values and the relative paths to the INFO file. User can choose
this INFO file and SrRietveld will load the data file specified.</li>
</ul>
<p>In this example, select the <em>NaCl_All.info</em> file in the directory NaCl_RAPDF_example/Data/,
The list of data files and the temperature will be listed in a dialog before load into the
refinement (<a class="reference internal" href="#fg-load-data-dialogue-box"><em>Figure</em></a>).</p>
<blockquote>
<div><a class="reference external" href="_images/load_data.png">Enlarge</a></div></blockquote>
<img alt="_images/load_data.png" class="align-center" id="fg-load-data-dialogue-box" src="_images/load_data.png" style="width: 640px; height: 488px;" />
<p class="centered">
<strong>The load data dialogue box.  This is obtained by making an experiment active by selecting the
main experiment tab (in this case it is called &#8220;NaCl&#8221;), then clicking on the <em>Load</em> drop-down menu and
selecting <em>data</em>.  We have browsed to the directory containing the data and selected the <em>NaCl.info</em> file
that contains a list of data-files and the temperature at which the data were measured.  In this figure all
the files are shown selected, so when &#8220;replace&#8221; button is clicked these datasets will be loaded into this
experiment (replacing any data-files that were associated with the experiment). Only the selected files will
be loaded.</strong></p><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">By default, all the files in the <em>.info</em> are selected but this can be changed using normal selection methods
(select a single file, select multiples files by holding down Ctrl button and clicking files, or select
ranges of files by holding down <em>shift</em> and clicking the file at each end of the range).</p>
</div>
<p>The <em>NaCl_All.info</em> file is a multi column text file, which contains the datafile names and
the corresponding temperature on which the data were collected. After the sequential refinement
data are loaded, select <strong>Pattern</strong> in the <em>Experiments</em> panel. We see that it contains a row of
meta data for each loaded dataset (<a class="reference internal" href="#fg-pattern-panel"><em>Figure</em></a>). The names of the files that
correspond to each row are in the <strong>Datafile</strong> column. Similarly, the <strong>Instrumentfile</strong> contains
the instrument file path, and the <strong>MFIL</strong> column contains the incident spectrum data file path (for GSAS refinements).</p>
<p>Details about the data file list file (<em>.info</em> file) format can be found <a class="reference internal" href="reference.html#sec-data-files"><em>here</em></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>In the case of multi-bank data, data file for each bank has to be specified. If a data file for a bank is missing,
the data file path from the previous bank will be copied, otherwise, if more data files are listed than the number
of the banks, the extra data file will be ignored.</p>
<blockquote class="last">
<div><a class="reference external" href="_images/pattern_node.png">Enlarge</a></div></blockquote>
</div>
<img alt="_images/pattern_node.png" class="align-center" id="fg-pattern-panel" src="_images/pattern_node.png" style="width: 640px; height: 473px;" />
<p class="centered">
<strong>The <strong>Pattern</strong> setup panel.  We can see which data-files, or diffraction &#8220;patterns&#8221;, are associated with
the experiment by clicking on the <em>pattern</em> node in the experiment and looking in the main panel.
Also apparent in this panel are other parameters in the fits that are associated with the pattern such as
background parameters and the instrument parameter file that will be used with the refinement.</strong></p></div>
<div class="section" id="refinement-strategy">
<span id="id1"></span><h3>Refinement Strategy<a class="headerlink" href="#refinement-strategy" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For more details on strategy in SrRietveld, please see <a class="reference internal" href="reference.html#sec-refinement-strategy"><em>here</em></a>.</p>
</div>
<p>Now we have loaded a EXP file and created an &#8220;refinement&#8221; and we have associated
a series of data-sets to this experiment.  We are now ready to set up the refinement strategy.
SrRietveld uses strategies to automate refinements in place of the extensive human interaction
necessary with GSAS or FullProf.</p>
<p>The strategy is a sequence of refinements on one data set. To obtain convergence, usually fewer parameters will be turned on at the beginning steps of the strategy and more parameters will be turned on at the following steps. At the last step all parameters to be refined will be turned on. This process can improve the convergence of the refinement on one data set when the starting value is not close enough to the results. While in most cases, the user will have a refinement setup file with good results ready to establish a project in SrRietveld, the strategy steps will be turned off by default. The user can also let the program to automatically turn on the strategy steps when the refinement diverges on one dataset. Therefore when the refinement diverges, the software will rerun the refinement with all strategy steps turned on on the same dataset. If the second trial fails again, the software will mark the bad dataset and continue to the next.</p>
<p>The turned on parameter will show a prefix <em>&#64;</em> in its label. To add a parameter to a step of strategy, user can select that column, and right click on the column label,  hover the mouse over <strong>Turn on parameters</strong> submenu, user can remove or add this parameter to the listed steps.</p>
<p>Select the <strong>Strategy</strong> icon on the NaCl experiment in the <em>Experiments</em> panel.
The SrRietveld default strategy can be seen in the strategy panel to the right. We will use the default strategy so there is no need to edit it. Users can edit the strategy in the strategy editor panel. The user defined strategy can also be exported to local disk as a text file, which can be loaded into another experiment with same refinement engine.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">SrRietveld sets up a default strategy for each newly created experiment. For details of
how to edit the strategy, please go <a class="reference internal" href="reference.html#sec-refinement-strategy"><em>here</em></a></p>
</div>
</div>
<div class="section" id="real-time-plotting">
<h3>Real Time Plotting<a class="headerlink" href="#real-time-plotting" title="Permalink to this headline">¶</a></h3>
<p>Now we will open the real time plot windows so we can follow the refinement. When the refinement starts,
all the fits in the experiment will be carried out.  We can choose to follow any refined parameter, or
the goodness-of-fit R-factors, as a function of the fit number or, if as here we have associated a parameter
such as temperature with each fit, we can plot the refined parameter vs. temperature.  We would like
to follow the T-dependence of the <em>a</em>-lattice parameter. To do this we need to select this parameter column.
Either select the <em>AllVariables</em> or <em>Phase</em> node in the NaCl experiment in the <em>Experiments</em>.  The main
panel will then show either all the variables in a huge table, or just the parameters associated with the structural
model of the phase.  All the variables associated with a single fit are in a single column of the table.</p>
<p>Scroll until you find the parameter of interest and select the column by clicking on the top of the column.  Then click <em>Tools -&gt; Plot</em> from the Menu Bar, or click the plot icon in the Tool Bar. A plot window will pop up (<a class="reference internal" href="#fg-plot-window"><em>Figure</em></a>).</p>
<p>You can select more than one parameter to plot by holding down Ctrl and selecting more parameters. If two parameters have similar values they will look good in one plot window, which will auto-scale based on the refined values. You can open as many plot windows as you like and so it is also possible to follow multiple parameters with different values in multiple plot windows.</p>
<blockquote>
<div><a class="reference external" href="_images/plot_window.png">Enlarge</a></div></blockquote>
<img alt="_images/plot_window.png" class="align-center" id="fg-plot-window" src="_images/plot_window.png" style="width: 640px; height: 488px;" />
<p class="centered">
<strong>A plot window has been opened by selecting the column corresponding to the parameter, in this case it is the <em>a</em>-lattice parameter then clicking the plot icon on the tool bar.  It looks flat because the refinements have not started and the initial values for this parameter is the same for each fit at each temperature.</strong></p><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since the refinement has not started yet, the curve in the plot window is a straight line. However, The shape of the curve will be updated in real time after the refinement starts.</p>
</div>
</div>
<div class="section" id="add-a-job-to-the-job-list">
<h3>Add a job to the job list<a class="headerlink" href="#add-a-job-to-the-job-list" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><a class="reference external" href="_images/add_job.png">Enlarge</a></div></blockquote>
<img alt="_images/add_job.png" class="align-center" src="_images/add_job.png" style="width: 640px; height: 488px;" />
<p>To add a job to the job list of the project, one has to select a refinement in the <em>Experiment</em> panel, and select the datasets to be included in the job from the right panel (grid panel). Then click on the menu item <em>Experiment-&gt;Add job</em>. The job will be added and shown in the <em>Job</em> panel list. To be noted, If no dataset is selected in the grid panel when adding the job, all datasets in the selected refinement will be included in the job.</p>
<p>A detailed instruction on the <em>Job</em> panel can be found in <cite>:ref:here &lt;the_job_panel&gt;</cite>.</p>
</div>
<div class="section" id="start-the-sequential-refinement">
<h3>Start the Sequential Refinement<a class="headerlink" href="#start-the-sequential-refinement" title="Permalink to this headline">¶</a></h3>
<p>To start the refinement jobs listed in the <em>Job</em> panel, simply click on the <strong>Start a refinement</strong> button in the tool bar. SrRietveld will automatically run the refinement jobs in the job panel from the top of the list. Because of the large number of fits, the refinement will take some time to complete.  You can take a break and have a coffee and come back later to view the results, or you can interrupt the fit and restart it with fewer data-sets loaded (see bellow).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>During a refinement, SrRietveld switches to the strategy view, with the active refinement step highlighted, output
messages from the engine will be printed in the output panel, and the parameter values in the strategy
view and the plot window will be updated in real time (<a class="reference internal" href="#fg-srrietveld-running"><em>Figure</em></a>). The grid data view above the strategy panel will also be updated in real time during the refinement.</p>
<p class="last"><a class="reference external" href="_images/running.png">Enlarge</a></p>
</div>
<img alt="_images/running.png" class="align-center" id="fg-srrietveld-running" src="_images/running.png" style="width: 640px; height: 485px;" />
<p class="centered">
<strong>SrRietveld is running</strong></p><p>User can also refine certain fits in the list. Simply select the rows in the data grid view on the right panel, and start the refinement by right clicking on the row labels, then SrRietveld will refine only the selected fits.</p>
</div>
<div class="section" id="handling-divergent-refinements">
<h3>Handling Divergent Refinements<a class="headerlink" href="#handling-divergent-refinements" title="Permalink to this headline">¶</a></h3>
<p>FullProf has difficulty converging the fit at certain temperatures, which would require considerable human intervention if FullProf were being used without SrRietveld.  However SrRietveld can handle the divergence during sequential refinement. When the refinement on certain temperature diverges, SrRietveld will skip the current dataset and continue on the refinement on the next refinement. The diverged datasets will be highlighted in the result grid view, as can be seen in the figure bellow. The results shown in the figure are saved in the project file <em>NaCl_step_over.srr</em> file under the example folder.</p>
<p>To converge the diverged fits you can try and rerun the refinements.  Each data-set has a status associated with it so that SrRietveld knows if it is not-run, converged, or not converged.  The refinement can be rerun on all datasets or just not-run and not-converged datasets.  If necessary you can change the starting parameter values or the refinement strategy by editing in the SrRietveld window to help convergence.</p>
<blockquote>
<div><a class="reference external" href="_images/exception.png">Enlarge</a></div></blockquote>
<img alt="_images/exception.png" class="align-center" id="fg-exception" src="_images/exception.png" style="width: 640px; height: 400px;" />
<p class="centered">
<strong>The SrRietveld software can handle the diverged refinement on datasets during sequential refinements. The above figure shows the results of the sequential refinements with a different version of FullProf which produced some diverged refinements on some datasets, which is highlighted in the grid view. The step-over example results are saved in <em>NaCl_step_back.srr</em> in the example folder.</strong></p><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The results shown above are obtained with FullProf v4.80. We also found that different versions of FullProf may produce different refinement results on our testing with the same settings. So if you get any results different from what are showing above, a different version number may be the reason.</p>
</div>
</div>
<div class="section" id="viewing-the-results">
<h3>Viewing the Results<a class="headerlink" href="#viewing-the-results" title="Permalink to this headline">¶</a></h3>
<p>After the refinements are complete, to view the results, click on the highest node in the <em>Experiments</em> panel (<em>NaCl_EXP</em> in our example). The results, consisting of all the refined parameters and their standard deviations, will appear in the right panel (<a class="reference internal" href="#fg-result-panel"><em>Figure</em></a>). It can be seen that there are several checkboxes, above the grid data view, <em>All, Unrefined, Converged, and Diverged</em>. Users can use these checkboxes to filter the refinement to be shown in the grid bellow.</p>
<blockquote>
<div><a class="reference external" href="_images/result.png">Enlarge</a></div></blockquote>
<img alt="_images/result.png" class="align-center" id="fg-result-panel" src="_images/result.png" style="width: 640px; height: 473px;" />
<p class="centered">
<strong>The result panel</strong></p><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In the result panel the uncertainties will show when possible. The uncertainties will not be
displayed in other panels.</p>
</div>
<ul class="simple">
<li>To plot the result values against the environment parameters, select the entire column by click on the label, click on <em>Tools-&gt;Plot</em> or click on the plot button on the tool bar</li>
<li>To plot two result values against each other, select the two columns, click on <em>Tools-&gt;Plot XY</em></li>
<li>To plot the refinement history of a result value, switch to the result panel (click <em>NaCl</em> node on the left <em>Experiments</em> panel), select the entire column in the result panel to the right, click on <em>Tools-&gt;Plot history</em></li>
<li>To plot the current pattern of the diffraction data, select the <em>NaCl</em> node on the <em>Experiments</em> panel, click on <em>Tools-&gt;Plot</em> or click on the plot button on the tool bar</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>As can be seen in the plot window interface, the functionality of SrRietveld plot window is extended (<a class="reference internal" href="#fg-extended-plot-window"><em>Figure</em></a>). The details about the extended plot window in SrRietveld can be found in <a class="reference internal" href="reference.html#sec-plot-window"><em>here</em></a>.</p>
<blockquote class="last">
<div><a class="reference external" href="_images/plot_setup.png">Enlarge</a></div></blockquote>
</div>
<img alt="_images/plot_setup.png" class="align-center" id="fg-extended-plot-window" src="_images/plot_setup.png" style="width: 640px; height: 473px;" />
<p class="centered">
<strong>The extended plot window</strong></p></div>
<div class="section" id="setup-and-run-the-fullprof-refinement-with-srrietveld">
<h3>Setup and Run the FullProf Refinement with SrRietveld<a class="headerlink" href="#setup-and-run-the-fullprof-refinement-with-srrietveld" title="Permalink to this headline">¶</a></h3>
<p>User can load more than one refinements in a project. As the GSAS refinement has already completed on the NaCl data, users can load the FullProf refinement into the project. Simply click <strong>Add new refinement...</strong> button in the toolbar and select the <em>PCR</em> file in the example folder. One can load the data and start the refinement similar as shown above.</p>
</div>
<div class="section" id="after-the-refinement">
<h3>After the Refinement<a class="headerlink" href="#after-the-refinement" title="Permalink to this headline">¶</a></h3>
<p>SrRietveld provides convenient access to the refinement data and results.</p>
<div class="section" id="export-the-data-view-to-csv-file">
<h4>Export the data view to CSV file<a class="headerlink" href="#export-the-data-view-to-csv-file" title="Permalink to this headline">¶</a></h4>
<p>The values in the grid data view can be exported to <em>CSV</em> file. Users can click the menu button <strong>Export-&gt;CSV</strong>. A dialog will be popped up for the user to input the csv file name. If no cell is selected in the grid view, the whole view will be exported to the csv file. The user can also select the cell in the grid data view and export. In this case, the minimum block in the data view containing the selected cells will be exported.</p>
</div>
<div class="section" id="load-the-data-view-from-a-text-data-file">
<h4>Load the data view from a text data file<a class="headerlink" href="#load-the-data-view-from-a-text-data-file" title="Permalink to this headline">¶</a></h4>
<p>If users would like to change the values in the grid view, a text data file in multi column or CSV format can be loaded into the grid. By clicking <strong>Menu-&gt;Load-&gt;Import text data</strong>, a preview dialog will show. User can choose the format of the file, or make any changed on values on cells, before importing these data into the grid view.
.. _fg_import_text_data:</p>
<blockquote>
<div><img alt="_images/import_text_data.png" class="align-center" src="_images/import_text_data.png" style="width: 640px;" />
<p class="centered">
<strong>The extended plot window</strong></p></div></blockquote>
</div>
<div class="section" id="export-the-refinement-setup-files">
<h4>Export the refinement setup files<a class="headerlink" href="#export-the-refinement-setup-files" title="Permalink to this headline">¶</a></h4>
<p>User can also export the refinement results to the <em>EXP</em> or <em>pcr</em> files which are recognizable by GSAS and FullProf, respectively. User can select the single refinement in the grid data view, from which the data will be exported, and then select the <strong>Export-&gt;EXP/pcr</strong> and a dialog will pop up. Users can input the descriptive part of the file name, the software will prefix the user given name to distinguish the setup file exported from different refinements in a sequence.</p>
</div>
<div class="section" id="export-the-distance-and-angle-information-from-the-refinement">
<h4>Export the distance and angle information from the refinement<a class="headerlink" href="#export-the-distance-and-angle-information-from-the-refinement" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The DISAGL file exportation is only available for refinement with GSAS engine.</p>
</div>
<p>Similar to the refinement setup files, the distance and angle information can be exported to DISAGL files. User can select the single refinement in the grid data view, from which the data will be exported, and then select the <strong>Export-&gt;DISAGL</strong> and a dialog will pop up. Users can input the descriptive part of the file name, the software will prefix the user given name to distinguish the setup file exported from different refinements in a sequence.</p>
</div>
</div>
<div class="section" id="re-running-the-refinement">
<h3>Re-running the Refinement<a class="headerlink" href="#re-running-the-refinement" title="Permalink to this headline">¶</a></h3>
<p>Depending on the results, one might need to re-run the refinement using different initial values. To change the initial values, select the node that you&#8217;re interested in from the <em>Experiments</em> panel, then double click the cell whose value you want to change in the right panel, edit the value, and then hit Enter to update the value. Once all changes have been made, reset the fits status via <strong>Refinement-&gt;Reset</strong>, then re-run the refinement as detailed above.</p>
<p>Additionally, it is also possible to update the initial values using GSAS or FullProf and then reloading the setup file in SrRietveld.</p>
</div>
<div class="section" id="stop-the-sequential-refinement">
<h3>Stop the Sequential Refinement<a class="headerlink" href="#stop-the-sequential-refinement" title="Permalink to this headline">¶</a></h3>
<p>While SrRietveld is running refinements on sequential data, the sequential refinement can be terminated at any time by clicking the <em>Stop</em> button in the tool bar (also available in the menu <em>Run-&gt;stop</em>), as shown in the Figure bellow.</p>
<blockquote>
<div><a class="reference external" href="_images/stop_sequential.png">Enlarge</a></div></blockquote>
<img alt="_images/stop_sequential.png" class="align-center" id="fg-stop-sequential" src="_images/stop_sequential.png" style="width: 640px;" />
<p class="centered">
<strong>Stop the sequential refinement by clicking the button in tool bar</strong></p><p>Please be noted that the <em>Stop</em> button will only be activated when the sequential refinement is running and the top node of the experiment on the left panel is selected (<em>NaCl</em> in this case). After stopped the sequential refinement can be restarted by click the <em>Start a refinement</em> button in tool bar or <em>Run-&gt;Sequential</em> in the menu.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">While the stop button is clicked, the SrRietveld will record this event and stop after finish the refinement on current dataset.</p>
</div>
</div>
<div class="section" id="saving-and-loading-project-files">
<h3>Saving and Loading Project Files<a class="headerlink" href="#saving-and-loading-project-files" title="Permalink to this headline">¶</a></h3>
<p>The user can save the current settings by click on <em>File-&gt;Save Project...</em>, results, and strategy into a stand-alone binary file in HDF5 format, with the file extension <em>.SRR</em>. This file can be loaded to analyze the result or continue refinement.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The refinement strategy information will be also saved in the project binary file. The data file and instrument file paths will be saved in the project binary file.</p>
</div>
<p>In the example folder there are two HDF5 project files provided.</p>
<blockquote>
<div><ul class="simple">
<li><strong>NaCl.srr</strong> &#8211; the project file with FullProf as refinement engine</li>
</ul>
</div></blockquote>
<p>To open an project, click <em>File-&gt;Open project...</em> in menu or directly click on the open file icon in tool bar, then just choose the data file to load from the opened file dialog.</p>
<p>These files contains the complete refinement setup information and refinement results for two different refinement engines. User can view the results and settings saved in the <em>.SRR</em> file via.</p>
</div>
<div class="section" id="archive-the-project-file-and-source-files-in-zip">
<h3>Archive the Project File and Source Files in zip<a class="headerlink" href="#archive-the-project-file-and-source-files-in-zip" title="Permalink to this headline">¶</a></h3>
<p>It is possible to archive the project file and source files in a zip file, which is much smaller thus convenient to handle via internet. To archive the current project, the user can click on the <strong>Archive project in zip</strong> button in toolbar. Then a file dialog will show, by which user can select the path and file name of the zip file.</p>
</div>
</div>
<div class="section" id="bug-report-and-user-feedback">
<h2>Bug Report and User Feedback<a class="headerlink" href="#bug-report-and-user-feedback" title="Permalink to this headline">¶</a></h2>
<div class="section" id="bugs-bite-me">
<h3>Bugs Bite Me!<a class="headerlink" href="#bugs-bite-me" title="Permalink to this headline">¶</a></h3>
<p>Though efforts are made to make SrRietveld program bug-free, different work environments, unexpected conditions, or various platforms and hardwares may cause errors while using this program. In this case, if you can report the error message back to the development group, it will help us in improvement on SrRietveld greatly. Users can submit the bug reports to the developers mailing list in Google group: <a class="reference external" href="http://groups.google.com/group/srrietveld-dev">http://groups.google.com/group/srrietveld-dev</a>.</p>
<p>For your convenience, when the program encounters an error, a report window will pop up, as can be seen in the following figure.</p>
<blockquote>
<div><a class="reference external" href="_images/bug_report.png">Enlarge</a></div></blockquote>
<img alt="_images/bug_report.png" class="align-center" src="_images/bug_report.png" style="width: 542px;" />
<p class="centered">
<strong>The bug report window when the program encuonters an error.</strong></p><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Though the user&#8217;s email address is optional in the error report form, we encourage the user to provide this information, so that the developers can contact the user for more details of the reported error.</p>
</div>
</div>
<div class="section" id="user-feedback-and-community">
<h3>User Feedback and Community<a class="headerlink" href="#user-feedback-and-community" title="Permalink to this headline">¶</a></h3>
<p>The opinions from SrRietveld users are important to us. The user community can also be used to solve issues in various use cases. If you have any questions, suggestions, feature request, or just some ideas to share with us, please share with us in the SrRietveld user online community in Google Groups: <a class="reference external" href="http://groups.google.com/group/srrietveld-users">http://groups.google.com/group/srrietveld-users</a>.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="scripting_interface.html" title="Scripting Interface"
             >next</a></li>
        <li class="right" >
          <a href="install.html" title="Installation"
             >previous</a> |</li>
        <li><a href="index.html">SrRietveld 1.0-r6875 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Peng Tian, Wenduo Zhou, Jiwu Liu, Yingrui Shang, Chris Farrow, Pavol Juhas, Emil Bozin, and Simon Billinge.
      Last updated on Jan 11, 2013.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>